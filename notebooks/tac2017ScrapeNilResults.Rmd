---
jupyter:
  jupytext:
    text_representation:
      extension: .Rmd
      format_name: rmarkdown
      format_version: '1.2'
      jupytext_version: 1.11.4
  kernelspec:
    display_name: Python 3
    language: python
    name: python3
---

```{python}
from bs4 import BeautifulSoup
import pandas as pd
import requests
import re
```

```{python}
url = 'https://tac.nist.gov/publications/2017/results.html'
base = 'https://tac.nist.gov/publications/2017'
```

```{python}
res = requests.get(url)
```

```{python}
def _process_paper(paperurl):
    resl = requests.get(paperurl)
    df = pd.DataFrame(columns=[
        'paper',
        'runid',
        'langs',
        'prec',
        'recall',
        'f1'
    ])
    paper = paperurl.split('/')[-1]
    for line in resl.text.split('\n'):
        if 'Run ID:' in line:
            runid = re.match('Run ID:\s+([^\s]+)', line).group(1)
        if line.endswith(':'):
            langs = line
        if 'strong_typed_nil_match' in line:
            prec, recall, f1 = re.match('\s*([0-9.]+)\s+([0-9.]+)\s+([0-9.]+)\s*', line).groups()
            df = df.append({
                'paper': paper,
                'runid': runid,
                'langs': langs,
                'prec': prec,
                'recall': recall,
                'f1': f1
            }, ignore_index=True)
    return df
```

```{python}
if res.ok:
    soup = BeautifulSoup(res.content)
```

```{python}
df = pd.DataFrame()
for link in soup.find_all('a'):
    if 'EDL' in link.text:
        paperlink = link.get('href')
        paperlink = base + paperlink[1:]
        df = pd.concat([df, _process_paper(paperlink)])
```

```{python}
df.sort_values(by='f1', ascending=False).head(20)
```

```{python}
print('Go here to look at the papers: https://tac.nist.gov/publications/2017/papers.html')
```
